- name: Add hxlogs path
  ansible.builtin.file:
    path: /hxlogs
    state: directory
    owner: perforce
    group: perforce
    mode: '0755'

- name: Add hxdepots path
  ansible.builtin.file:
    path: /hxdepots
    state: directory
    owner: perforce
    group: perforce
    mode: '0755'

- name: Add hxmetadata path
  ansible.builtin.file:
    path: /hxmetadata
    state: directory
    owner: perforce
    group: perforce
    mode: '0755'

- name: Get NFS host IP Address
  ansible.builtin.shell: "nslookup {{sdp_commit_nfs_host}} |grep Address |grep -v \\# |awk '{print $2}'"
  register: nfs_host_ip

- name: Add NFS mounts
  ansible.builtin.lineinfile:
    path: /etc/fstab
    line: "{{nfs_host_ip.stdout}}:/nfs/hxdepots /hxdepots nfs defaults 0 0"
    insertafter: '^#'
    owner: root
    group: root
    mode: '0644'
